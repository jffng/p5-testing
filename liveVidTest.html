<!DOCTYPE html>
<head>
	<script src="http://cdnjs.cloudflare.com/ajax/libs/p5.js/0.2.2/p5.min.js"></script>
</head>
<body>
	<script type="text/javascript">
		var canvas,video,ctx,frame,img;

		var errorCallback = function(e) {
			console.log('Reeeejected!', e);
		};

		function setup () {
			var width = 320;
			var height = 240;
			canvas = createCanvas(width,height);
			canvas.position(0,0);
			video = document.createElement('video');
			ctx = canvas.context;

			video.width = 36;
			video.height = 24;
			video.autoplay = true;
			navigator.webkitGetUserMedia({video:true}, function(stream) {
					video.src = window.webkitURL.createObjectURL(stream);
					console.log(stream);
				}, errorCallback
      		);
		}

		function snapshot() {
			if( video.readyState === video.HAVE_ENOUGH_DATA ){
				ctx.drawImage(video, 0, 0);
				frame = ctx.canvas.toDataURL('image/webp');

				img = loadImage(frame);
				img.loadPixels();
			}
 		}

 		function p5shit(){
			if (mouseIsPressed()) {
				fill(0);
			} else {
				fill(255);
			}
			ellipse(mouseX, mouseY, 80, 80); 			
 		}

		function draw (){
			// p5shit();
			
			snapshot();
		}

	</script>
</body>